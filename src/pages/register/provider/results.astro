---
import Layout from '../../../layouts/Layout.astro';
import Header from '../../../components/Header.astro';
import Footer from '../../../components/Footer.astro';

// Simulación de clientes potenciales
const potentialClients = [
  {
    id: 1,
    name: "Innovatech Solutions",
    industry: "tech",
    location: "Madrid, España",
    size: "medium",
    budget: "medium",
    description: "Empresa de desarrollo de software buscando soluciones de ciberseguridad.",
    match: 95,
    premium: true
  },
  {
    id: 2,
    name: "Constructora ABC",
    industry: "construction",
    location: "Barcelona, España",
    size: "large",
    budget: "large",
    description: "Empresa de construcción en búsqueda de proveedores de materiales.",
    match: 88,
    premium: false
  },
  {
    id: 3,
    name: "HealthCare Plus",
    industry: "health",
    location: "Valencia, España",
    size: "small",
    budget: "medium",
    description: "Clínica privada buscando servicios de gestión de pacientes.",
    match: 82,
    premium: true
  },
  {
    id: 4,
    name: "EduTech Innovators",
    industry: "education",
    location: "Sevilla, España",
    size: "medium",
    budget: "small",
    description: "Startup de tecnología educativa buscando soluciones de e-learning.",
    match: 78,
    premium: false
  },
  {
    id: 5,
    name: "Finanzas Seguras",
    industry: "financial",
    location: "Bilbao, España",
    size: "large",
    budget: "enterprise",
    description: "Empresa de servicios financieros buscando soluciones de seguridad.",
    match: 85,
    premium: true
  },
  {
    id: 6,
    name: "Retail Solutions",
    industry: "retail",
    location: "Zaragoza, España",
    size: "small",
    budget: "medium",
    description: "Empresa de comercio minorista buscando soluciones de gestión de inventarios.",
    match: 80,
    premium: false
  },
  {
    id: 7,
    name: "Manufacturing Pro",
    industry: "manufacturing",
    location: "Málaga, España",
    size: "large",
    budget: "enterprise",
    description: "Empresa industrial en búsqueda de optimización de procesos.",
    match: 73,
    premium: true
  }
];
---

<Layout title="Clientes Potenciales | B2B Connect">
  <Header />
  
  <main class="pt-32 pb-20 bg-white">
    <div class="container mx-auto px-4">
      <div class="max-w-5xl mx-auto">
        <div class="text-center max-w-3xl mx-auto mb-10">
          <h1 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
            ¡Hemos encontrado clientes para ti!
          </h1>
          <p class="text-xl text-gray-600">
            Basados en tu perfil, estos son los clientes que podrían estar interesados en tus servicios.
          </p>
        </div>
        
        <div class="bg-white rounded-xl shadow-md p-6 md:p-8 mb-10 border border-gray-100">
          <!-- Resumen y filtros -->
          <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-8 gap-4">
            <div>
              <h2 class="text-2xl font-bold text-gray-900">
                {potentialClients.length} clientes encontrados
              </h2>
              <p class="text-gray-600" id="plan-status-message">
                <!-- Se rellenará con JavaScript -->
              </p>
            </div>
            <div class="flex items-center text-blue-600 whitespace-nowrap">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z" />
              </svg>
              <span class="text-sm font-medium">Filtrar resultados</span>
            </div>
          </div>
          
          <!-- Lista de clientes -->
          <div id="results-container" class="space-y-4">
            {potentialClients.map((client, index) => (
              <div class={`border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow ${client.premium ? 'relative overflow-hidden' : ''}`}>
                {client.premium && (
                  <div class="absolute top-0 right-0">
                    <div class="bg-yellow-500 text-white px-8 py-1 rotate-45 translate-x-6 -translate-y-1 text-sm font-semibold">
                      PREMIUM
                    </div>
                  </div>
                )}
                
                <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
                  <div class="flex-1">
                    <div class="flex flex-wrap items-center gap-2 mb-1">
                      <h3 class="text-lg font-semibold text-gray-900">{client.name}</h3>
                      <span class="bg-blue-100 text-blue-800 text-xs px-2 py-0.5 rounded-full">
                        {client.industry === 'tech' ? 'Tecnología' : 
                         client.industry === 'construction' ? 'Construcción' : 
                         client.industry === 'health' ? 'Salud' : 
                         client.industry === 'education' ? 'Educación' :
                         client.industry === 'financial' ? 'Finanzas' :
                         client.industry === 'retail' ? 'Comercio' : 
                         client.industry === 'manufacturing' ? 'Manufactura' : client.industry}
                      </span>
                      <span class="bg-green-100 text-green-800 text-xs px-2 py-0.5 rounded-full flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                        </svg>
                        <span>{client.match}% coincidencia</span>
                      </span>
                    </div>
                    <p class="text-gray-600 text-sm mb-2">{client.description}</p>
                    <div class="flex flex-wrap items-center gap-4 text-sm text-gray-500">
                      <span class="flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                        </svg>
                        {client.location}
                      </span>
                      <span class="flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                        </svg>
                        {client.size === 'micro' ? '1-10 empleados' : 
                         client.size === 'small' ? '11-50 empleados' : 
                         client.size === 'medium' ? '51-250 empleados' : '250+ empleados'}
                      </span>
                      <span class="flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        {client.budget === 'small' ? 'Menos de 1.000€' : 
                         client.budget === 'medium' ? '1.000€ - 10.000€' : 
                         client.budget === 'large' ? '10.000€ - 50.000€' : 'Más de 50.000€'}
                      </span>
                    </div>
                  </div>
                  <div class="flex justify-end">
                    <button 
                      class="client-details-button px-4 py-2 bg-blue-600 text-white font-medium rounded-lg transition-colors hover:bg-blue-700 whitespace-nowrap"
                      data-client-id={client.id}
                      data-premium={client.premium ? 'true' : 'false'}
                    >
                      {client.premium ? 'Ver detalles' : 'Desbloquear'}
                    </button>
                  </div>
                </div>
              </div>
            ))}
          </div>
          
          <div class="mt-8 p-4 border border-blue-200 bg-blue-50 rounded-lg text-center">
            <p id="upgrade-message" class="text-blue-800 mb-4">
              <!-- Se rellenará con JavaScript -->
            </p>
            <div id="upgrade-button-container" class="flex justify-center">
              <!-- Se rellenará con JavaScript -->
            </div>
          </div>
        </div>
        
        <div class="text-center mb-8">
          <a href="/dashboard" class="px-6 py-3 bg-blue-600 text-white font-medium rounded-lg transition-colors hover:bg-blue-700 shadow-md">
            Ir al Dashboard
          </a>
        </div>
        
        <div class="bg-gray-50 border border-gray-100 rounded-lg p-6 text-center">
          <h2 class="text-2xl font-bold text-gray-900 mb-3">Completa tu perfil para mejorar tus coincidencias</h2>
          <p class="text-gray-600 mb-6">
            Añade más información a tu perfil para que podamos conectarte con más clientes potenciales y mejorar tus coincidencias.
          </p>
          <a href="/profile/complete" class="px-6 py-3 border border-blue-600 text-blue-600 font-medium rounded-lg transition-colors hover:bg-blue-50">
            Completar perfil
          </a>
        </div>
      </div>
    </div>
  </main>
  
  <!-- Modal para desbloquear cliente premium -->
  <div id="unlock-modal" class="fixed inset-0 z-50" style="display: none; background-color: rgba(0,0,0,0.4);">
    <div class="flex items-center justify-center min-h-screen p-4">
      <div class="bg-white rounded-xl max-w-md w-full overflow-y-auto shadow-xl">
        <div class="p-6">
          <h2 class="text-2xl font-bold text-gray-900 mb-4">Desbloquea más clientes</h2>
          <p class="text-gray-600 mb-6">
            Para acceder a los detalles y poder contactar con este cliente, necesitas actualizar a un plan Premium.
          </p>
          
          <div class="bg-blue-50 border border-blue-200 rounded-lg p-5 mb-6">
            <h3 class="text-xl font-semibold text-gray-900 mb-2">Plan Premium</h3>
            <div class="text-3xl font-bold text-blue-700 mb-4">$29.99 <span class="text-sm font-normal text-gray-600">/ mes</span></div>
            <ul class="text-left space-y-2 mb-6">
              <li class="flex items-start">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-green-500 flex-shrink-0 mt-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                </svg>
                <span>Acceso a todos los clientes potenciales</span>
              </li>
              <li class="flex items-start">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-green-500 flex-shrink-0 mt-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                </svg>
                <span>Información completa de contacto</span>
              </li>
              <li class="flex items-start">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-green-500 flex-shrink-0 mt-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                </svg>
                <span>Mensajería directa con clientes</span>
              </li>
            </ul>
            <button id="upgrade-plan-button" class="w-full px-6 py-3 bg-blue-600 text-white font-medium rounded-lg transition-colors hover:bg-blue-700 shadow-sm">
              Actualizar plan
            </button>
          </div>
          
          <div class="flex justify-end">
            <button id="close-unlock-modal" class="px-4 py-2 text-gray-600 hover:text-gray-800">
              Cancelar
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Modal para detalles del cliente -->
  <div id="client-details-modal" class="fixed inset-0 z-50" style="display: none; background-color: rgba(0,0,0,0.4);">
    <div class="flex items-center justify-center min-h-screen p-4">
      <div class="bg-white rounded-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto shadow-xl">
        <div class="sticky top-0 bg-white p-4 border-b border-gray-200 flex justify-between items-center">
          <h2 class="text-2xl font-bold text-gray-900" id="client-modal-title">Detalles del cliente</h2>
          <button id="close-details-modal" class="text-gray-500 hover:text-gray-700 transition-colors p-1 rounded-full hover:bg-gray-100">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
        <div class="p-6" id="client-modal-content">
          <!-- El contenido se cargará dinámicamente -->
        </div>
      </div>
    </div>
  </div>
  
  <Footer />
</Layout>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    // Verificar que el usuario viene del flujo correcto
    const providerData = sessionStorage.getItem('providerData');
    if (!providerData) {
      window.location.href = '/register/provider/form';
      return;
    }
    
    const parsedProviderData = JSON.parse(providerData);
    const isPremium = parsedProviderData.plan !== 'free';
    
    // Mostrar mensaje según el plan
    const planStatusMessage = document.getElementById('plan-status-message');
    const upgradeMessage = document.getElementById('upgrade-message');
    const upgradeButtonContainer = document.getElementById('upgrade-button-container');
    
    if (planStatusMessage) {
      if (isPremium) {
        planStatusMessage.innerHTML = `<span class="text-green-600 font-medium">Plan ${parsedProviderData.plan === 'premium' ? 'Premium' : 'Pro'} activo</span> - Tienes acceso a todos los detalles de contacto`;
      } else {
        planStatusMessage.innerHTML = '<span class="text-yellow-600 font-medium">Plan Básico</span> - Acceso limitado a detalles de contacto';
      }
    }
    
    if (upgradeMessage && upgradeButtonContainer) {
      if (isPremium) {
        upgradeMessage.textContent = '¡Gracias por elegir nuestro plan premium! Tienes acceso completo a todos los clientes potenciales.';
        upgradeButtonContainer.innerHTML = `
          <a href="/dashboard" class="px-6 py-3 border border-blue-600 text-blue-600 font-medium rounded-lg transition-colors hover:bg-blue-50">
            Ver dashboard completo
          </a>
        `;
      } else {
        upgradeMessage.textContent = 'Actualiza tu plan para desbloquear el acceso completo a todos los clientes potenciales y sus datos de contacto.';
        upgradeButtonContainer.innerHTML = `
          <button id="main-upgrade-button" class="px-6 py-3 bg-blue-600 text-white font-medium rounded-lg transition-colors hover:bg-blue-700 shadow-md">
            Actualizar a Premium
          </button>
        `;
        
        // Añadir evento al botón de actualización principal
        document.getElementById('main-upgrade-button')?.addEventListener('click', () => {
          const unlockModal = document.getElementById('unlock-modal');
          if (unlockModal) {
            unlockModal.style.display = 'block';
          }
        });
      }
    }
    
    // Configurar botones de detalles de cliente
    const clientButtons = document.querySelectorAll('.client-details-button');
    const clientDetailsModal = document.getElementById('client-details-modal');
    const unlockModal = document.getElementById('unlock-modal');
    const closeDetailsModalButton = document.getElementById('close-details-modal');
    const closeUnlockModalButton = document.getElementById('close-unlock-modal');
    const upgradePlanButton = document.getElementById('upgrade-plan-button');
    
    // Datos de clientes para cargar en el modal
    const clients = [
      {
        id: 1,
        name: "Innovatech Solutions",
        industry: "tech",
        location: "Madrid, España",
        size: "medium",
        budget: "medium",
        description: "Empresa de desarrollo de software buscando soluciones de ciberseguridad.",
        longDescription: "Innovatech Solutions es una empresa líder en desarrollo de software que está buscando implementar soluciones avanzadas de ciberseguridad para proteger su infraestructura y los datos de sus clientes. Tienen un equipo de 120 empleados y están en fase de expansión internacional.",
        match: 95,
        premium: true,
        contact: {
          name: "Alejandro Fernández",
          position: "Director de Tecnología",
          email: "afernandez@innovatech.com",
          phone: "+34 912 345 678"
        },
        requirements: ["Auditoría de seguridad", "Implementación de firewalls", "Protección contra ataques DDoS", "Formación en seguridad"],
        budget_range: "30.000€ - 45.000€"
      },
      // Datos adicionales para otros clientes...
    ];
    
    clientButtons.forEach(button => {
      button.addEventListener('click', () => {
        const clientId = parseInt(button.dataset.clientId);
        const isPremiumClient = button.dataset.premium === 'true';
        
        // Si el usuario no tiene plan premium y el cliente es premium, mostrar modal de desbloqueo
        if (!isPremium && isPremiumClient) {
          if (unlockModal) {
            unlockModal.style.display = 'block';
          }
          return;
        }
        
        // Buscar los datos del cliente (en una app real se haría una petición)
        const client = clients.find(c => c.id === clientId) || potentialClients.find(c => c.id === clientId);
        
        if (client && clientDetailsModal) {
          // Mostrar el modal con los detalles
          const modalTitle = document.getElementById('client-modal-title');
          const modalContent = document.getElementById('client-modal-content');
          
          if (modalTitle) {
            modalTitle.textContent = client.name;
          }
          
          if (modalContent) {
            // Generar contenido según si el usuario tiene plan premium
            if (isPremium) {
              // Contenido completo para usuarios premium
              modalContent.innerHTML = generateFullClientDetails(client);
            } else {
              // Contenido limitado para usuarios básicos
              modalContent.innerHTML = generateLimitedClientDetails(client);
            }
          }
          
          clientDetailsModal.style.display = 'block';
        }
      });
    });
    
    // Cerrar modales
    if (closeDetailsModalButton) {
      closeDetailsModalButton.addEventListener('click', () => {
        if (clientDetailsModal) {
          clientDetailsModal.style.display = 'none';
        }
      });
    }
    
    if (closeUnlockModalButton) {
      closeUnlockModalButton.addEventListener('click', () => {
        if (unlockModal) {
          unlockModal.style.display = 'none';
        }
      });
    }
    
    // Actualizar plan
    if (upgradePlanButton) {
      upgradePlanButton.addEventListener('click', () => {
        upgradePlanButton.disabled = true;
        upgradePlanButton.innerHTML = '<span class="inline-block animate-spin mr-2">⏳</span> Procesando...';
        
        setTimeout(() => {
          // Simular actualización de plan
          const providerData = JSON.parse(sessionStorage.getItem('providerData') || '{}');
          providerData.plan = 'premium';
          sessionStorage.setItem('providerData', JSON.stringify(providerData));
          
          // Cerrar modal y mostrar mensaje
          if (unlockModal) {
            unlockModal.style.display = 'none';
          }
          
          // Recargar la página para reflejar los cambios
          window.location.reload();
        }, 1500);
      });
    }
    
    // Función para generar HTML con detalles completos del cliente
    function generateFullClientDetails(client) {
      return `
        <div class="space-y-6">
          <div class="flex items-start justify-between">
            <div>
              <div class="flex flex-wrap items-center gap-2">
                <span class="bg-blue-100 text-blue-800 text-xs px-2 py-0.5 rounded-full">
                  ${client.industry === 'tech' ? 'Tecnología' : 
                   client.industry === 'construction' ? 'Construcción' : 
                   client.industry === 'health' ? 'Salud' : 
                   client.industry === 'education' ? 'Educación' :
                   client.industry === 'financial' ? 'Finanzas' :
                   client.industry === 'retail' ? 'Comercio' : 
                   client.industry === 'manufacturing' ? 'Manufactura' : client.industry}
                </span>
                <span class="bg-green-100 text-green-800 text-xs px-2 py-0.5 rounded-full flex items-center">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                  </svg>
                  <span>${client.match}% coincidencia</span>
                </span>
              </div>
            </div>
            <div class="text-right">
              <button class="px-4 py-2 bg-green-600 text-white font-medium rounded-lg transition-colors hover:bg-green-700 flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
                </svg>
                Contactar
              </button>
            </div>
          </div>
          
          <div>
            <h3 class="text-lg font-semibold text-gray-900 mb-2">Ubicación</h3>
            <div class="flex items-center text-gray-700">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg>
              ${client.location}
            </div>
          </div>
          
          <div>
            <h3 class="text-lg font-semibold text-gray-900 mb-2">Descripción</h3>
            <p class="text-gray-700">${client.longDescription || client.description}</p>
          </div>
          
          ${client.requirements ? `
          <div>
            <h3 class="text-lg font-semibold text-gray-900 mb-2">Requisitos</h3>
            <ul class="list-disc list-inside space-y-1 text-gray-700">
              ${client.requirements.map(req => `<li>${req}</li>`).join('')}
            </ul>
          </div>
          ` : ''}
          
          <div>
            <h3 class="text-lg font-semibold text-gray-900 mb-2">Presupuesto estimado</h3>
            <p class="text-gray-700 font-medium">${client.budget_range || (
              client.budget === 'small' ? 'Menos de 1.000€' : 
              client.budget === 'medium' ? '1.000€ - 10.000€' : 
              client.budget === 'large' ? '10.000€ - 50.000€' : 'Más de 50.000€'
            )}</p>
          </div>
          
          <div class="border-t border-gray-200 pt-4 mt-6">
            <h3 class="text-lg font-semibold text-gray-900 mb-2">Información de contacto</h3>
            ${client.contact ? `
              <div class="space-y-2">
                <div class="flex items-center text-gray-700">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                  </svg>
                  ${client.contact.name} - ${client.contact.position}
                </div>
                <div class="flex items-center text-gray-700">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                  </svg>
                  ${client.contact.phone}
                </div>
                <div class="flex items-center text-gray-700">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                  </svg>
                  <a href="mailto:${client.contact.email}" class="text-blue-600 hover:underline">${client.contact.email}</a>
                </div>
              </div>
            ` : `
              <p class="text-gray-700">Contacta para obtener más información.</p>
            `}
          </div>
          
          <div class="flex justify-between pt-4 border-t border-gray-200">
            <button class="px-4 py-2 border border-blue-600 text-blue-600 font-medium rounded-lg transition-colors hover:bg-blue-50">
              Guardar cliente
            </button>
            <button class="px-4 py-2 bg-blue-600 text-white font-medium rounded-lg transition-colors hover:bg-blue-700">
              Enviar propuesta
            </button>
          </div>
        </div>
      `;
    }
    
    // Función para generar HTML con detalles limitados del cliente
    function generateLimitedClientDetails(client) {
      return `
        <div class="space-y-6">
          <div class="flex items-start justify-between">
            <div>
              <div class="flex flex-wrap items-center gap-2">
                <span class="bg-blue-100 text-blue-800 text-xs px-2 py-0.5 rounded-full">
                  ${client.industry === 'tech' ? 'Tecnología' : 
                   client.industry === 'construction' ? 'Construcción' : 
                   client.industry === 'health' ? 'Salud' : 
                   client.industry === 'education' ? 'Educación' :
                   client.industry === 'financial' ? 'Finanzas' :
                   client.industry === 'retail' ? 'Comercio' : 
                   client.industry === 'manufacturing' ? 'Manufactura' : client.industry}
                </span>
                <span class="bg-green-100 text-green-800 text-xs px-2 py-0.5 rounded-full flex items-center">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                  </svg>
                  <span>${client.match}% coincidencia</span>
                </span>
              </div>
            </div>
          </div>
          
          <div>
            <h3 class="text-lg font-semibold text-gray-900 mb-2">Ubicación</h3>
            <div class="flex items-center text-gray-700">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg>
              ${client.location}
            </div>
          </div>
          
          <div>
            <h3 class="text-lg font-semibold text-gray-900 mb-2">Descripción</h3>
            <p class="text-gray-700">${client.description}</p>
          </div>
          
          <div class="border-t border-gray-200 pt-6 mt-6">
            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-6 text-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto text-yellow-500 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
              </svg>
              <h4 class="text-lg font-semibold text-gray-900 mb-2">Información de contacto bloqueada</h4>
              <p class="text-gray-700 mb-4">Actualiza a un plan Premium para ver la información completa de contacto y poder comunicarte con este cliente.</p>
              <button id="modal-upgrade-button" class="px-6 py-3 bg-blue-600 text-white font-medium rounded-lg transition-colors hover:bg-blue-700 shadow-md">
                Actualizar a Premium
              </button>
            </div>
          </div>
        </div>
      `;
    }
    
    // Cerrar modales haciendo clic fuera o con ESC
    window.addEventListener('click', (e) => {
      if (e.target === clientDetailsModal) {
        clientDetailsModal.style.display = 'none';
      }
      if (e.target === unlockModal) {
        unlockModal.style.display = 'none';
      }
    });
    
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        if (clientDetailsModal && clientDetailsModal.style.display === 'block') {
          clientDetailsModal.style.display = 'none';
        }
        if (unlockModal && unlockModal.style.display === 'block') {
          unlockModal.style.display = 'none';
        }
      }
    });
    
    // Configurar botones de actualización en el modal de detalles
    document.addEventListener('click', (e) => {
      if (e.target && e.target.id === 'modal-upgrade-button') {
        if (clientDetailsModal) {
          clientDetailsModal.style.display = 'none';
        }
        if (unlockModal) {
          unlockModal.style.display = 'block';
        }
      }
    });
  });
</script>