---
import Layout from '../../../layouts/Layout.astro';
import Header from '../../../components/Header.astro';
import Footer from '../../../components/Footer.astro';

// Simulación de proveedores encontrados según los criterios
const mockProviders = [
  {
    id: 1,
    name: "TechSolutions Inc.",
    industry: "tech",
    location: "Madrid, España",
    description: "Servicios IT y soluciones tecnológicas para empresas.",
    longDescription: "TechSolutions Inc. ofrece soluciones tecnológicas integrales para empresas de todos los tamaños. Con más de 10 años de experiencia en el sector, nos especializamos en desarrollo de software, consultoría IT, ciberseguridad y servicios en la nube.",
    rating: 4.8,
    reviews: 124,
    verified: true,
    contact: {
      phone: "+34 912 456 789",
      email: "contacto@techsolutions.com",
      website: "https://www.techsolutions-inc.com"
    },
    services: ["Desarrollo de software", "Consultoría IT", "Ciberseguridad", "Cloud Computing"],
    clients: ["Banco Nacional", "Grupo Empresarial MTZ", "Seguros Universales", "Tech Innovations"]
  },
  {
    id: 2,
    name: "Global Logistics",
    industry: "transport",
    location: "Barcelona, España",
    description: "Servicios de logística y transporte internacional.",
    longDescription: "Global Logistics es una empresa líder en soluciones logísticas internacionales. Ofrecemos servicios de transporte terrestre, marítimo y aéreo, así como almacenamiento y distribución de mercancías. Nuestra red global garantiza entregas eficientes y seguras.",
    rating: 4.5,
    reviews: 89,
    verified: true,
    contact: {
      phone: "+34 932 789 456",
      email: "info@globallogistics.com",
      website: "https://www.globallogistics-transport.com"
    },
    services: ["Transporte internacional", "Almacenamiento", "Distribución", "Gestión aduanera"],
    clients: ["Productos Ecológicos SA", "Textiles Europeos", "Grupo Comercial FCB", "Importaciones del Este"]
  },
  {
    id: 3,
    name: "Constructora Moderna",
    industry: "construction",
    location: "Valencia, España", 
    description: "Servicios de construcción y reforma para proyectos comerciales.",
    longDescription: "Constructora Moderna ofrece servicios integrales de construcción y reforma para proyectos comerciales e industriales. Con un enfoque en la sostenibilidad y la eficiencia, desarrollamos proyectos arquitectónicos adaptados a las necesidades específicas de cada cliente.",
    rating: 4.7,
    reviews: 56,
    verified: true,
    contact: {
      phone: "+34 962 333 444",
      email: "proyectos@constructoramoderna.es",
      website: "https://www.constructoramoderna.es"
    },
    services: ["Construcción comercial", "Reformas industriales", "Consultoría arquitectónica", "Proyectos de sostenibilidad"],
    clients: ["Centros Comerciales Reunidos", "Industrias Valencia", "Grupo Hotelero Sun", "Oficinas Centrales BLM"]
  },
  {
    name: "HealthTech Solutions",
    industry: "health",
    location: "Londres, Reino Unido",
    description: "Equipamiento médico y soluciones para el sector sanitario.",
    rating: 4.9,
    reviews: 72,
    verified: true
  },
  {
    name: "Green Energy Co.",
    industry: "energy",
    location: "Berlín, Alemania",
    description: "Soluciones de energía renovable y consultoría energética.",
    rating: 4.6,
    reviews: 48,
    verified: false
  },
  {
    name: "Digital Marketing Group",
    industry: "tech",
    location: "Sevilla, España",
    description: "Servicios de marketing digital y posicionamiento web.",
    rating: 4.3,
    reviews: 35,
    verified: true
  },
  {
    name: "Industrial Supplies Co.",
    industry: "manufacturing",
    location: "Milán, Italia",
    description: "Suministros industriales y materias primas para fabricación.",
    rating: 4.4,
    reviews: 67,
    verified: true
  }
];
---

<Layout title="Resultados de búsqueda | B2B Connect">
  <Header />
  
  <main class="pt-32 pb-20 bg-white">
    <div class="container mx-auto px-4">
      <div class="max-w-5xl mx-auto">
        <!-- Indicador de progreso -->
        <div class="mb-12">
          <div class="flex items-center justify-between">
            <div class="flex items-center">
              <div class="w-10 h-10 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold">
                ✓
              </div>
              <div class="ml-3 text-blue-600 font-semibold">Rubros</div>
            </div>
            <div class="flex-grow mx-4 h-1 bg-blue-600"></div>
            <div class="flex items-center">
              <div class="w-10 h-10 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold">
                ✓
              </div>
              <div class="ml-3 text-blue-600 font-semibold">Alcance</div>
            </div>
            <div class="flex-grow mx-4 h-1 bg-blue-600"></div>
            <div class="flex items-center">
              <div class="w-10 h-10 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold">
                3
              </div>
              <div class="ml-3 text-blue-600 font-semibold">Resultados</div>
            </div>
          </div>
        </div>
        
        <div class="bg-white rounded-xl shadow-md p-6 md:p-8 mb-10 border border-gray-100">
          <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-8 gap-4">
            <h1 class="text-2xl md:text-3xl font-bold text-gray-900">
              ¡Hemos encontrado {mockProviders.length} proveedores para tu negocio!
            </h1>
            <div class="flex items-center text-blue-600 whitespace-nowrap">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z" />
              </svg>
              <span class="text-sm font-medium">Filtros aplicados</span>
            </div>
          </div>
          
          <!-- Lista de proveedores (con blur) -->
          <div id="results-container" class="space-y-4 relative">
            <div class="blur-sm pointer-events-none">
              {mockProviders.map(provider => (
                <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                  <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
                    <div class="flex-1">
                      <div class="flex flex-wrap items-center gap-2 mb-1">
                        <h3 class="text-lg font-semibold text-gray-900">{provider.name}</h3>
                        {provider.verified && (
                          <span class="bg-green-100 text-green-800 text-xs px-2 py-0.5 rounded-full flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                            </svg>
                            Verificado
                          </span>
                        )}
                      </div>
                      <p class="text-gray-600 text-sm mb-2">{provider.description}</p>
                      <div class="flex flex-wrap items-center gap-4 text-sm text-gray-500">
                        <span class="flex items-center">
                          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                          </svg>
                          {provider.location}
                        </span>
                        <span class="flex items-center">
                          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-yellow-500" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" />
                          </svg>
                          {provider.rating} ({provider.reviews} reseñas)
                        </span>
                      </div>
                    </div>
                    <div class="flex justify-end">
                      <button 
                        class="view-details-button px-4 py-2 bg-blue-600 text-white font-medium rounded-lg transition-colors hover:bg-blue-700 whitespace-nowrap"
                        data-provider-id={provider.id}
                      >
                        Ver detalles
                      </button>
                    </div>
                  </div>
                </div>
              ))}
            </div>
            
            <!-- Overlay de desbloqueo inicial ($9) -->
            <div id="initial-paywall-overlay" class="absolute inset-0 flex flex-col items-center justify-center bg-white bg-opacity-90 rounded-lg p-4">
              <div class="text-center max-w-md px-4">
                <div class="w-20 h-20 mx-auto mb-6 text-blue-600">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-full h-full" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                  </svg>
                </div>
                <h3 class="text-2xl font-bold text-gray-900 mb-3">Desbloquea los resultados</h3>
                <p class="text-gray-600 mb-6">
                  Has encontrado {mockProviders.length} proveedores que coinciden con tus necesidades. Desbloquea estos resultados con un único pago.
                </p>
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6 shadow-sm">
                  <h4 class="text-xl font-semibold text-gray-900 mb-2">Oferta especial</h4>
                  <div class="text-3xl font-bold text-blue-700 mb-4">$9 <span class="text-sm font-normal text-gray-600">/ único pago</span></div>
                  <ul class="text-left space-y-2 mb-6">
                    <li class="flex items-start">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-green-500 flex-shrink-0 mt-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                      </svg>
                      <span>Acceso a todos los resultados de esta búsqueda</span>
                    </li>
                    <li class="flex items-start">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-green-500 flex-shrink-0 mt-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                      </svg>
                      <span>Información básica de los proveedores</span>
                    </li>
                    <li class="flex items-start">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-green-500 flex-shrink-0 mt-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                      </svg>
                      <span>Opciones adicionales disponibles después</span>
                    </li>
                  </ul>
                  <button id="unlock-basic-results-button" class="w-full px-6 py-3 bg-blue-600 text-white font-medium rounded-lg transition-colors hover:bg-blue-700 shadow-sm">
                    Desbloquear por $9
                  </button>
                </div>
                <div class="flex items-center justify-center text-xs text-gray-500">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                  </svg>
                  <span>Pago 100% seguro. Si no encuentras lo que buscas, te devolvemos tu dinero.</span>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="text-center mt-12">
          <div class="flex justify-center gap-4">
            <a href="/register/client/step2" class="px-6 py-3 border border-blue-600 text-blue-600 font-medium rounded-lg transition-colors hover:bg-blue-50">
              Volver a la búsqueda
            </a>
          </div>
        </div>
      </div>
    </div>
  </main>
  
  <!-- Modal con información básica de proveedor (después del pago inicial) -->
  <div id="provider-basic-modal" class="fixed inset-0 z-50" style="display: none; background-color: rgba(0,0,0,0.4);">
    <div class="flex items-center justify-center min-h-screen p-4">
      <div class="bg-white rounded-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto shadow-xl">
        <div class="sticky top-0 bg-white p-4 border-b border-gray-200 flex justify-between items-center">
          <h2 class="text-2xl font-bold text-gray-900" id="modal-title">Detalles del proveedor</h2>
          <button id="close-basic-modal" class="text-gray-500 hover:text-gray-700 transition-colors p-1 rounded-full hover:bg-gray-100">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
        <div class="p-6" id="modal-basic-content">
          <!-- El contenido se cargará dinámicamente -->
        </div>
      </div>
    </div>
  </div>
  
  <!-- Modal de registro y planes premium -->
  <div id="premium-registration-modal" class="fixed inset-0 z-50" style="display: none; background-color: rgba(0,0,0,0.4);">
    <div class="flex items-center justify-center min-h-screen p-4">
      <div class="bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto shadow-xl">
        <div class="sticky top-0 bg-white p-4 border-b border-gray-200 flex justify-between items-center">
          <h2 class="text-2xl font-bold text-gray-900">Accede a información completa</h2>
          <button id="close-premium-modal" class="text-gray-500 hover:text-gray-700 transition-colors p-1 rounded-full hover:bg-gray-100">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
        <div class="p-6">
          <div id="registration-step" class="space-y-6">
            <p class="text-gray-600">
              Para acceder a la información completa de contacto y comunicarte directamente con los proveedores, necesitas crear una cuenta.
            </p>
            
            <!-- Formulario de registro -->
            <form id="client-registration-form">
              <div class="space-y-4 mb-6">
                <div>
                  <label for="company" class="block text-sm font-medium text-gray-700 mb-1">Nombre de la Empresa</label>
                  <input 
                    type="text" 
                    id="company" 
                    name="company" 
                    required
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"
                    placeholder="Nombre de tu empresa"
                  >
                </div>
                
                <div>
                  <label for="name" class="block text-sm font-medium text-gray-700 mb-1">Nombre y Apellido</label>
                  <input 
                    type="text" 
                    id="name" 
                    name="name" 
                    required
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"
                    placeholder="Tu nombre completo"
                  >
                </div>
                
                <div>
                  <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Correo Electrónico</label>
                  <input 
                    type="email" 
                    id="email" 
                    name="email" 
                    required
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"
                    placeholder="ejemplo@empresa.com"
                  >
                </div>
                
                <div>
                  <label for="password" class="block text-sm font-medium text-gray-700 mb-1">Contraseña</label>
                  <input 
                    type="password" 
                    id="password" 
                    name="password" 
                    required
                    minlength="8"
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"
                    placeholder="Mínimo 8 caracteres"
                  >
                </div>
                
                <!-- Términos y condiciones -->
                <div class="flex items-start">
                  <div class="flex items-center h-5">
                    <input 
                      type="checkbox" 
                      id="terms" 
                      name="terms" 
                      required
                      class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"
                    >
                  </div>
                  <div class="ml-3 text-sm">
                    <label for="terms" class="text-gray-600">
                      Acepto los <a href="/terms" class="text-blue-600 hover:underline">Términos y Condiciones</a> y la <a href="/privacy" class="text-blue-600 hover:underline">Política de Privacidad</a>
                    </label>
                  </div>
                </div>
              </div>
              
              <button 
                type="submit" 
                id="register-button"
                class="w-full px-6 py-3 bg-blue-600 text-white font-medium rounded-lg transition-colors hover:bg-blue-700 shadow-sm"
              >
                Registrarme y continuar
              </button>
            </form>
          </div>
          
          <div id="plans-step" class="hidden space-y-6">
            <p class="text-gray-600 mb-4">
              Selecciona el plan que mejor se adapte a tus necesidades para acceder a información completa de proveedores.
            </p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <!-- Plan Estándar -->
              <div class="border-2 border-blue-200 rounded-xl p-6 bg-white relative">
                <div class="absolute top-0 right-0 bg-blue-600 text-white text-xs font-bold px-3 py-1 rounded-bl-md">POPULAR</div>
                <h3 class="text-xl font-bold text-gray-900 mb-2">Plan Estándar</h3>
                <div class="text-3xl font-bold text-blue-700 mb-4">$29.99 <span class="text-sm font-normal text-gray-600">/ mes</span></div>
                <ul class="space-y-2 mb-6">
                  <li class="flex items-start">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-green-500 flex-shrink-0 mt-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                    <span>Información completa de contacto</span>
                  </li>
                  <li class="flex items-start">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-green-500 flex-shrink-0 mt-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                    <span>10 contactos directos al mes</span>
                  </li>
                  <li class="flex items-start">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-green-500 flex-shrink-0 mt-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                    <span>Soporte por email</span>
                  </li>
                </ul>
                <button 
                  class="select-plan-button w-full px-6 py-3 bg-blue-600 text-white font-medium rounded-lg transition-colors hover:bg-blue-700 shadow-sm"
                  data-plan="standard"
                >
                  Seleccionar plan
                </button>
              </div>
              
              <!-- Plan Pro -->
              <div class="border-2 border-gray-200 rounded-xl p-6 bg-white">
                <h3 class="text-xl font-bold text-gray-900 mb-2">Plan Pro</h3>
                <div class="text-3xl font-bold text-blue-700 mb-4">$59.99 <span class="text-sm font-normal text-gray-600">/ mes</span></div>
                <ul class="space-y-2 mb-6">
                  <li class="flex items-start">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-green-500 flex-shrink-0 mt-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                    <span>Todo lo del Plan Estándar</span>
                  </li>
                  <li class="flex items-start">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-green-500 flex-shrink-0 mt-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                    <span>Contactos ilimitados</span>
                  </li>
                  <li class="flex items-start">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-green-500 flex-shrink-0 mt-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                    <span>Soporte telefónico prioritario</span>
                  </li>
                </ul>
                <button 
                  class="select-plan-button w-full px-6 py-3 border border-blue-600 text-blue-600 font-medium rounded-lg transition-colors hover:bg-blue-50"
                  data-plan="pro"
                >
                  Seleccionar plan
                </button>
              </div>
            </div>
          </div>
          
          <div id="payment-step" class="hidden space-y-6">
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
              <div class="flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <p class="text-blue-800 text-sm">Este es un entorno de simulación. No se realizará ningún cargo real.</p>
              </div>
            </div>
            
            <div class="p-6 border border-gray-200 rounded-lg">
              <h3 class="text-lg font-medium text-gray-900 mb-4" id="payment-summary-title">Plan Estándar - $29.99/mes</h3>
              
              <!-- Simulación de formulario de pago -->
              <div class="space-y-4">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Número de tarjeta</label>
                  <input type="text" value="4242 4242 4242 4242" readonly class="w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none">
                </div>
                <div class="grid grid-cols-2 gap-4">
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Fecha de expiración</label>
                    <input type="text" value="12/25" readonly class="w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">CVC</label>
                    <input type="text" value="123" readonly class="w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none">
                  </div>
                </div>
              </div>
              
              <button 
                id="process-payment-button"
                class="w-full mt-6 px-6 py-3 bg-blue-600 text-white font-medium rounded-lg transition-colors hover:bg-blue-700 shadow-sm"
              >
                Realizar pago
              </button>
            </div>
          </div>
          
          <div id="success-step" class="hidden space-y-6 text-center">
            <div class="w-20 h-20 mx-auto mb-6 text-green-500">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-full w-full" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
            </div>
            <h3 class="text-2xl font-bold text-gray-900">¡Pago exitoso!</h3>
            <p class="text-gray-600">
              Tu cuenta ha sido creada y activada exitosamente. Ahora tienes acceso completo a todos los detalles de proveedores.
            </p>
            <button 
              id="view-full-results-button"
              class="mt-4 px-6 py-3 bg-blue-600 text-white font-medium rounded-lg transition-colors hover:bg-blue-700 shadow-sm"
            >
              Ver resultados completos
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Modal de detalles completos (después del registro y pago premium) -->
  <div id="provider-premium-modal" class="fixed inset-0 z-50" style="display: none; background-color: rgba(0,0,0,0.4);">
    <div class="flex items-center justify-center min-h-screen p-4">
      <div class="bg-white rounded-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto shadow-xl">
        <div class="sticky top-0 bg-white p-4 border-b border-gray-200 flex justify-between items-center">
          <h2 class="text-2xl font-bold text-gray-900" id="modal-premium-title">Detalles completos del proveedor</h2>
          <button id="close-premium-details-modal" class="text-gray-500 hover:text-gray-700 transition-colors p-1 rounded-full hover:bg-gray-100">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
        <div class="p-6" id="modal-premium-content">
          <!-- El contenido se cargará dinámicamente -->
        </div>
      </div>
    </div>
  </div>
  
  <Footer />
</Layout>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    // Verificar que venimos del paso anterior
    if (!sessionStorage.getItem('selectedIndustries') || !sessionStorage.getItem('selectedScope')) {
      window.location.href = '/register/client/step1';
      return;
    }
    
    // Elementos DOM principales
    const unlockBasicButton = document.getElementById('unlock-basic-results-button');
    const initialPaywallOverlay = document.getElementById('initial-paywall-overlay');
    const resultsContainer = document.getElementById('results-container');
    const premiumRegistrationModal = document.getElementById('premium-registration-modal');
    const providerBasicModal = document.getElementById('provider-basic-modal');
    const providerPremiumModal = document.getElementById('provider-premium-modal');
    
    // Referencias a pasos del modal de registro/pago
    const registrationStep = document.getElementById('registration-step');
    const plansStep = document.getElementById('plans-step');
    const paymentStep = document.getElementById('payment-step');
    const successStep = document.getElementById('success-step');
    
    // Botones y formulario de registro
    const registrationForm = document.getElementById('client-registration-form');
    const registerButton = document.getElementById('register-button');
    const selectPlanButtons = document.querySelectorAll('.select-plan-button');
    const processPaymentButton = document.getElementById('process-payment-button');
    const viewFullResultsButton = document.getElementById('view-full-results-button');
    
    // Botones para cerrar modales
    const closePremiumModalButton = document.getElementById('close-premium-modal');
    const closeBasicModalButton = document.getElementById('close-basic-modal');
    const closePremiumDetailsModalButton = document.getElementById('close-premium-details-modal');
    
    // Datos de proveedores para cargar en los modales
    const providers = [
      {
        id: 1,
        name: "TechSolutions Inc.",
        industry: "tech",
        location: "Madrid, España",
        description: "Servicios IT y soluciones tecnológicas para empresas.",
        longDescription: "TechSolutions Inc. ofrece soluciones tecnológicas integrales para empresas de todos los tamaños. Con más de 10 años de experiencia en el sector, nos especializamos en desarrollo de software, consultoría IT, ciberseguridad y servicios en la nube.",
        rating: 4.8,
        reviews: 124,
        verified: true,
        contact: {
          name: "Alejandro Martínez",
          position: "Director Comercial",
          phone: "+34 912 456 789",
          email: "contacto@techsolutions.com",
          website: "https://www.techsolutions-inc.com"
        },
        services: ["Desarrollo de software", "Consultoría IT", "Ciberseguridad", "Cloud Computing"],
        clients: ["Banco Nacional", "Grupo Empresarial MTZ", "Seguros Universales", "Tech Innovations"]
      },
      {
        id: 2,
        name: "Global Logistics",
        industry: "transport",
        location: "Barcelona, España",
        description: "Servicios de logística y transporte internacional.",
        longDescription: "Global Logistics es una empresa líder en soluciones logísticas internacionales. Ofrecemos servicios de transporte terrestre, marítimo y aéreo, así como almacenamiento y distribución de mercancías. Nuestra red global garantiza entregas eficientes y seguras.",
        rating: 4.5,
        reviews: 89,
        verified: true,
        contact: {
          phone: "+34 932 789 456",
          email: "info@globallogistics.com",
          website: "https://www.globallogistics-transport.com"
        },
        services: ["Transporte internacional", "Almacenamiento", "Distribución", "Gestión aduanera"],
        clients: ["Productos Ecológicos SA", "Textiles Europeos", "Grupo Comercial FCB", "Importaciones del Este"]
      },
      {
        id: 3,
        name: "Constructora Moderna",
        industry: "construction",
        location: "Valencia, España", 
        description: "Servicios de construcción y reforma para proyectos comerciales.",
        longDescription: "Constructora Moderna ofrece servicios integrales de construcción y reforma para proyectos comerciales e industriales. Con un enfoque en la sostenibilidad y la eficiencia, desarrollamos proyectos arquitectónicos adaptados a las necesidades específicas de cada cliente.",
        rating: 4.7,
        reviews: 56,
        verified: true,
        contact: {
          phone: "+34 962 333 444",
          email: "proyectos@constructoramoderna.es",
          website: "https://www.constructoramoderna.es"
        },
        services: ["Construcción comercial", "Reformas industriales", "Consultoría arquitectónica", "Proyectos de sostenibilidad"],
        clients: ["Centros Comerciales Reunidos", "Industrias Valencia", "Grupo Hotelero Sun", "Oficinas Centrales BLM"]
      },
      // Datos para los otros proveedores serían similares
    ];
    
    // Estado de la aplicación
    let selectedProviderId = null;
    let selectedPlan = null;
    let userRegistered = false;
    let premiumAccess = false;
    
    // 1. Manejador para el pago inicial de $9
    if (unlockBasicButton) {
      unlockBasicButton.addEventListener('click', () => {
        // Simular procesamiento de pago
        unlockBasicButton.disabled = true;
        unlockBasicButton.innerHTML = '<svg class="animate-spin -ml-1 mr-3 h-5 w-5 inline-block text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Procesando...';
        
        setTimeout(() => {
          // Eliminar el overlay inicial
          if (initialPaywallOverlay) {
            initialPaywallOverlay.classList.add('fade-out');
            setTimeout(() => {
              initialPaywallOverlay.remove();
              document.querySelector('.blur-sm')?.classList.remove('blur-sm', 'pointer-events-none');
              setupViewDetailsButtons();
            }, 300);
          }
          
          // Guardar que el usuario ha pagado el acceso básico
          sessionStorage.setItem('basicAccessPaid', 'true');
          
          // Mostrar mensaje de éxito
          const successMessage = document.createElement('div');
          successMessage.className = 'fixed bottom-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50';
          successMessage.innerHTML = `
            <div class="flex items-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
              <span>¡Pago exitoso! Resultados desbloqueados.</span>
            </div>
          `;
          document.body.appendChild(successMessage);
          
          // Eliminar el mensaje después de unos segundos
          setTimeout(() => {
            successMessage.classList.add('fade-out');
            setTimeout(() => successMessage.remove(), 300);
          }, 3000);
        }, 1500);
      });
    }
    
    // 2. Configurar botones "Ver detalles" para abrir el modal correspondiente
    function setupViewDetailsButtons() {
      const detailButtons = document.querySelectorAll('.view-details-button');
      
      detailButtons.forEach(button => {
        button.addEventListener('click', () => {
          const providerId = parseInt(button.dataset.providerId);
          selectedProviderId = providerId;
          
          // Buscar datos del proveedor
          const provider = providers.find(p => p.id === providerId);
          
          if (provider) {
            // Verificar si el usuario tiene plan premium para mostrar detalles completos directamente
            if (userRegistered && premiumAccess) {
              // Si ya está registrado y tiene acceso premium, mostrar detalles completos directamente
              showPremiumDetails(provider);
            } else {
              // Si no tiene acceso premium, mostrar detalles básicos con opción de desbloqueo
              const modalTitle = document.getElementById('modal-title');
              const modalContent = document.getElementById('modal-basic-content');
              
              if (modalTitle) {
                modalTitle.textContent = provider.name;
              }
              
              if (modalContent) {
                modalContent.innerHTML = generateBasicProviderDetails(provider);
                
                // Configurar botón para desbloquear información completa
                const unlockFullDetailsButton = document.getElementById('unlock-full-details-button');
                if (unlockFullDetailsButton) {
                  unlockFullDetailsButton.addEventListener('click', () => {
                    // Ocultar modal básico y mostrar proceso de registro/pago
                    providerBasicModal.style.display = 'none';
                    premiumRegistrationModal.style.display = 'block';
                    
                    // Mostrar el paso correcto según si está registrado o no
                    if (userRegistered) {
                      registrationStep.classList.add('hidden');
                      plansStep.classList.remove('hidden');
                      paymentStep.classList.add('hidden');
                      successStep.classList.add('hidden');
                    } else {
                      registrationStep.classList.remove('hidden');
                      plansStep.classList.add('hidden');
                      paymentStep.classList.add('hidden');
                      successStep.classList.add('hidden');
                    }
                  });
                }
              }
              
              providerBasicModal.style.display = 'block';
            }
          }
        });
      });
    }
    
    // 3. Manejador para el formulario de registro
    if (registrationForm) {
      registrationForm.addEventListener('submit', (e) => {
        e.preventDefault();
        
        // Validar contraseña
        const password = document.getElementById('password').value;
        if (password.length < 8) {
          alert('La contraseña debe tener al menos 8 caracteres');
          return;
        }
        
        // Desactivar botón y mostrar carga
        registerButton.disabled = true;
        registerButton.innerHTML = '<svg class="animate-spin -ml-1 mr-3 h-5 w-5 inline-block text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Registrando...';
        
        // Recopilar datos del usuario
        const formData = {
          company: document.getElementById('company').value,
          name: document.getElementById('name').value,
          email: document.getElementById('email').value,
          plan: 'free', // Plan inicial gratuito
        };
        
        // Simular registro
        setTimeout(() => {
          // Guardar datos en sessionStorage
          sessionStorage.setItem('clientData', JSON.stringify(formData));
          userRegistered = true;
          
          // Actualizar UI para mostrar las opciones de plan
          registrationStep.classList.add('hidden');
          plansStep.classList.remove('hidden');
          
          // Actualizar el header para mostrar usuario autenticado
          updateAuthenticationStatus(formData);
        }, 1500);
      });
    }
    
    // 4. Manejadores para los botones de selección de plan
    selectPlanButtons.forEach(button => {
      button.addEventListener('click', () => {
        selectedPlan = button.dataset.plan;
        
        // Actualizar el resumen del pago
        const paymentSummaryTitle = document.getElementById('payment-summary-title');
        if (paymentSummaryTitle) {
          paymentSummaryTitle.textContent = selectedPlan === 'standard' ? 
            'Plan Estándar - $29.99/mes' : 
            'Plan Pro - $59.99/mes';
        }
        
        // Mostrar el paso de pago
        plansStep.classList.add('hidden');
        paymentStep.classList.remove('hidden');
      });
    });
    
    // 5. Manejador para el botón de procesamiento de pago
    if (processPaymentButton) {
      processPaymentButton.addEventListener('click', () => {
        // Simular procesamiento de pago
        processPaymentButton.disabled = true;
        processPaymentButton.innerHTML = '<svg class="animate-spin -ml-1 mr-3 h-5 w-5 inline-block text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Procesando...';
        
        setTimeout(() => {
          // Actualizar datos del usuario con el nuevo plan
          const clientData = JSON.parse(sessionStorage.getItem('clientData') || '{}');
          clientData.plan = selectedPlan;
          sessionStorage.setItem('clientData', JSON.stringify(clientData));
          premiumAccess = true;
          
          // Mostrar el paso de éxito
          paymentStep.classList.add('hidden');
          successStep.classList.remove('hidden');
          
          // Actualizar el header por si necesita mostrar el tipo de plan
          updateAuthenticationStatus(clientData);
        }, 2000);
      });
    }
    
    // 6. Manejador para ver resultados completos después del pago exitoso
    if (viewFullResultsButton) {
      viewFullResultsButton.addEventListener('click', () => {
        // Cerrar el modal de registro/pago
        premiumRegistrationModal.style.display = 'none';
        
        // Si hay un proveedor seleccionado, mostrar sus detalles completos
        if (selectedProviderId) {
          const provider = providers.find(p => p.id === selectedProviderId);
          if (provider) {
            showPremiumDetails(provider);
          }
        }
      });
    }
    
    // 7. Botones para cerrar modales
    if (closeBasicModalButton) {
      closeBasicModalButton.addEventListener('click', () => {
        providerBasicModal.style.display = 'none';
      });
    }
    
    if (closePremiumModalButton) {
      closePremiumModalButton.addEventListener('click', () => {
        premiumRegistrationModal.style.display = 'none';
      });
    }
    
    if (closePremiumDetailsModalButton) {
      closePremiumDetailsModalButton.addEventListener('click', () => {
        providerPremiumModal.style.display = 'none';
      });
    }
    
    // 8. Cerrar modales con Escape o click fuera
    window.addEventListener('click', (event) => {
      if (event.target === providerBasicModal) {
        providerBasicModal.style.display = 'none';
      }
      if (event.target === providerPremiumModal) {
        providerPremiumModal.style.display = 'none';
      }
      // No cerramos el modal de registro/pago al hacer click fuera para evitar pérdida de datos
    });
    
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        if (providerBasicModal && providerBasicModal.style.display === 'block') {
          providerBasicModal.style.display = 'none';
        }
        if (providerPremiumModal && providerPremiumModal.style.display === 'block') {
          providerPremiumModal.style.display = 'none';
        }
        // El modal de registro/pago requiere interacción explícita para cerrarse
      }
    });
    
    // 9. Funciones de generación de HTML para los modales
    function generateBasicProviderDetails(provider) {
      return `
        <div class="space-y-6">
          <div class="flex items-center gap-2">
            <span class="bg-blue-100 text-blue-800 text-xs px-2 py-0.5 rounded-full">
              ${provider.industry === 'tech' ? 'Tecnología' : 
               provider.industry === 'transport' ? 'Transporte' : 
               provider.industry === 'construction' ? 'Construcción' : 'Otro'}
            </span>
            ${provider.verified ? `
            <span class="bg-green-100 text-green-800 text-xs px-2 py-0.5 rounded-full flex items-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
              </svg>
              Verificado
            </span>
            ` : ''}
          </div>
          
          <div>
            <div class="flex items-center text-yellow-500 mb-1">
              ${'★'.repeat(Math.floor(provider.rating))}${provider.rating % 1 >= 0.5 ? '½' : ''}${'☆'.repeat(5 - Math.ceil(provider.rating))}
              <span class="ml-2 text-sm text-gray-600">${provider.rating} (${provider.reviews} reseñas)</span>
            </div>
          </div>
          
          <div>
            <h3 class="text-lg font-semibold text-gray-900 mb-2">Ubicación</h3>
            <div class="flex items-center text-gray-700">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg>
              ${provider.location}
            </div>
          </div>
          
          <div>
            <h3 class="text-lg font-semibold text-gray-900 mb-2">Descripción</h3>
            <p class="text-gray-700">${provider.description}</p>
          </div>
          
          <div class="border-t border-gray-200 pt-6 mt-6">
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-6 text-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto text-blue-500 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
              </svg>
              <h4 class="text-lg font-semibold text-gray-900 mb-2">Información detallada bloqueada</h4>
              <p class="text-gray-700 mb-4">Desbloquea la información completa de contacto, servicios detallados y más datos de este proveedor.</p>
              <button id="unlock-full-details-button" class="px-6 py-3 bg-blue-600 text-white font-medium rounded-lg transition-colors hover:bg-blue-700 shadow-md">
                Acceder a información completa
              </button>
            </div>
          </div>
        </div>
      `;
    }
    
    function generatePremiumProviderDetails(provider) {
      return `
        <div class="space-y-6">
          <div class="flex items-center justify-between">
            <div>
              <div class="flex flex-wrap items-center gap-2">
                <span class="bg-blue-100 text-blue-800 text-xs px-2 py-0.5 rounded-full">
                  ${provider.industry === 'tech' ? 'Tecnología' : 
                   provider.industry === 'transport' ? 'Transporte' : 
                   provider.industry === 'construction' ? 'Construcción' : 'Otro'}
                </span>
                ${provider.verified ? `
                <span class="bg-green-100 text-green-800 text-xs px-2 py-0.5 rounded-full flex items-center">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                  </svg>
                  Verificado
                </span>
                ` : ''}
              </div>
              <div class="flex items-center text-yellow-500 mt-1">
                ${'★'.repeat(Math.floor(provider.rating))}${provider.rating % 1 >= 0.5 ? '½' : ''}${'☆'.repeat(5 - Math.ceil(provider.rating))}
                <span class="ml-2 text-sm text-gray-600">${provider.rating} (${provider.reviews} reseñas)</span>
              </div>
            </div>
            <div class="text-right">
              <button class="px-4 py-2 bg-green-600 text-white font-medium rounded-lg transition-colors hover:bg-green-700 flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
                </svg>
                Contactar
              </button>
            </div>
          </div>
          
          <div>
            <h3 class="text-lg font-semibold text-gray-900 mb-2">Ubicación</h3>
            <div class="flex items-center text-gray-700">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg>
              ${provider.location}
            </div>
          </div>
          
          <div>
            <h3 class="text-lg font-semibold text-gray-900 mb-2">Descripción</h3>
            <p class="text-gray-700">${provider.longDescription || provider.description}</p>
          </div>
          
          ${provider.services ? `
          <div>
            <h3 class="text-lg font-semibold text-gray-900 mb-2">Servicios</h3>
            <div class="flex flex-wrap gap-2">
              ${provider.services.map(service => `
                <span class="bg-blue-100 text-blue-800 text-sm px-3 py-1 rounded-full">${service}</span>
              `).join('')}
            </div>
          </div>
          ` : ''}
          
          ${provider.clients ? `
          <div>
            <h3 class="text-lg font-semibold text-gray-900 mb-2">Clientes destacados</h3>
            <ul class="list-disc list-inside space-y-1 text-gray-700">
              ${provider.clients.map(client => `<li>${client}</li>`).join('')}
            </ul>
          </div>
          ` : ''}
          
          <div class="border-t border-gray-200 pt-4 mt-6">
            <h3 class="text-lg font-semibold text-gray-900 mb-2">Información de contacto</h3>
            ${provider.contact ? `
              <div class="space-y-2">
                <div class="flex items-center text-gray-700">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                  </svg>
                  ${provider.contact.name} - ${provider.contact.position}
                </div>
                <div class="flex items-center text-gray-700">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                  </svg>
                  ${provider.contact.phone}
                </div>
                <div class="flex items-center text-gray-700">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                  </svg>
                  <a href="mailto:${provider.contact.email}" class="text-blue-600 hover:underline">${provider.contact.email}</a>
                </div>
                <div class="flex items-center text-gray-700">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9" />
                  </svg>
                  <a href="${provider.contact.website}" target="_blank" class="text-blue-600 hover:underline">${provider.contact.website.replace('https://', '')}</a>
                </div>
              </div>
            ` : `
              <p class="text-gray-700">Contacta para obtener más información.</p>
            `}
          </div>
          
          <div class="flex justify-between pt-4 border-t border-gray-200">
            <button class="px-4 py-2 border border-blue-600 text-blue-600 font-medium rounded-lg transition-colors hover:bg-blue-50">
              Guardar proveedor
            </button>
            <button class="px-4 py-2 bg-blue-600 text-white font-medium rounded-lg transition-colors hover:bg-blue-700">
              Solicitar presupuesto
            </button>
          </div>
        </div>
      `;
    }
    
    // 10. Función para mostrar detalles premium
    function showPremiumDetails(provider) {
      const modalPremiumTitle = document.getElementById('modal-premium-title');
      const modalPremiumContent = document.getElementById('modal-premium-content');
      
      if (modalPremiumTitle) {
        modalPremiumTitle.textContent = provider.name;
      }
      
      if (modalPremiumContent) {
        modalPremiumContent.innerHTML = generatePremiumProviderDetails(provider);
      }
      
      if (providerPremiumModal) {
        providerPremiumModal.style.display = 'block';
      }
    }
    
    // 11. Función para actualizar el estado de autenticación en el header
    function updateAuthenticationStatus(userData) {
      const unauthenticatedState = document.getElementById('unauthenticated-state');
      const authenticatedState = document.getElementById('authenticated-state');
      const userNameElement = document.getElementById('user-name');
      const userTypeElement = document.getElementById('user-type');
      const dropdownUserName = document.getElementById('dropdown-user-name');
      const dropdownUserEmail = document.getElementById('dropdown-user-email');
      
      if (unauthenticatedState && authenticatedState && userData) {
        unauthenticatedState.classList.add('hidden');
        authenticatedState.classList.remove('hidden');
        
        if (userNameElement) {
          const firstName = userData.name.split(' ')[0];
          userNameElement.textContent = firstName;
        }
        
        if (userTypeElement) {
          const planLabel = userData.plan === 'free' ? 'Cliente' : 
                          userData.plan === 'standard' ? 'Cliente Premium' : 'Cliente Pro';
          userTypeElement.textContent = planLabel;
          
          // Estilo especial para planes premium
          if (userData.plan !== 'free') {
            userTypeElement.classList.remove('bg-gray-100', 'text-gray-600');
            userTypeElement.classList.add('bg-yellow-100', 'text-yellow-800');
          }
        }
        
        if (dropdownUserName) {
          dropdownUserName.textContent = userData.name;
        }
        
        if (dropdownUserEmail && userData.email) {
          dropdownUserEmail.textContent = userData.email;
        }
      }
    }
    
    // 12. Verificar el estado del usuario al cargar la página
    const clientData = sessionStorage.getItem('clientData');
    if (clientData) {
      const userData = JSON.parse(clientData);
      userRegistered = true;
      premiumAccess = userData.plan !== 'free';
      updateAuthenticationStatus(userData);
    }
    
    // 13. Verificar si ya pagó el acceso básico (por ejemplo, si recarga la página)
    if (sessionStorage.getItem('basicAccessPaid') === 'true') {
      if (initialPaywallOverlay) {
        initialPaywallOverlay.remove();
        document.querySelector('.blur-sm')?.classList.remove('blur-sm', 'pointer-events-none');
        setupViewDetailsButtons();
      }
    }
  });
</script>

<style>
  .fade-out {
    animation: fadeOut 0.3s forwards;
  }
  
  @keyframes fadeOut {
    from { opacity: 1; }
    to { opacity: 0; }
  }
</style>
